{"version":3,"sources":["node_modules/ms/index.js","node_modules/debug/src/common.js","node_modules/process/browser.js","node_modules/debug/src/browser.js","src/messages.ts","src/util.ts","src/license.ts","src/playback.ts","src/queue.ts","src/rpc.ts","src/index.ts"],"names":["cachedSetTimeout","cachedClearTimeout","process","module","exports","defaultSetTimout","Error","defaultClearTimeout","runTimeout","fun","setTimeout","e","call","runClearTimeout","marker","clearTimeout","currentQueue","queue","draining","queueIndex","cleanUpNextTick","length","concat","drainQueue","timeout","len","run","Item","array","noop","nextTick","args","Array","arguments","i","push","prototype","apply","title","env","argv","version","versions","on","addListener","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","name","binding","cwd","chdir","dir","umask","useColors","window","type","__nwjs","navigator","userAgent","toLowerCase","match","document","documentElement","style","WebkitAppearance","console","firebug","exception","table","parseInt","RegExp","$1","formatArgs","namespace","humanize","diff","c","color","splice","index","lastC","replace","log","save","namespaces","storage","setItem","removeItem","error","load","r","getItem","localstorage","localStorage","colors","require","formatters","j","v","JSON","stringify","message"],"mappings":"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","file":"src.3386e42f.js","sourceRoot":"../..","sourcesContent":["/**\n * Helpers.\n */\n\nvar s = 1000;\nvar m = s * 60;\nvar h = m * 60;\nvar d = h * 24;\nvar w = d * 7;\nvar y = d * 365.25;\n\n/**\n * Parse or format the given `val`.\n *\n * Options:\n *\n *  - `long` verbose formatting [false]\n *\n * @param {String|Number} val\n * @param {Object} [options]\n * @throws {Error} throw an error if val is not a non-empty string or a number\n * @return {String|Number}\n * @api public\n */\n\nmodule.exports = function(val, options) {\n  options = options || {};\n  var type = typeof val;\n  if (type === 'string' && val.length > 0) {\n    return parse(val);\n  } else if (type === 'number' && isNaN(val) === false) {\n    return options.long ? fmtLong(val) : fmtShort(val);\n  }\n  throw new Error(\n    'val is not a non-empty string or a valid number. val=' +\n      JSON.stringify(val)\n  );\n};\n\n/**\n * Parse the given `str` and return milliseconds.\n *\n * @param {String} str\n * @return {Number}\n * @api private\n */\n\nfunction parse(str) {\n  str = String(str);\n  if (str.length > 100) {\n    return;\n  }\n  var match = /^((?:\\d+)?\\-?\\d?\\.?\\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(\n    str\n  );\n  if (!match) {\n    return;\n  }\n  var n = parseFloat(match[1]);\n  var type = (match[2] || 'ms').toLowerCase();\n  switch (type) {\n    case 'years':\n    case 'year':\n    case 'yrs':\n    case 'yr':\n    case 'y':\n      return n * y;\n    case 'weeks':\n    case 'week':\n    case 'w':\n      return n * w;\n    case 'days':\n    case 'day':\n    case 'd':\n      return n * d;\n    case 'hours':\n    case 'hour':\n    case 'hrs':\n    case 'hr':\n    case 'h':\n      return n * h;\n    case 'minutes':\n    case 'minute':\n    case 'mins':\n    case 'min':\n    case 'm':\n      return n * m;\n    case 'seconds':\n    case 'second':\n    case 'secs':\n    case 'sec':\n    case 's':\n      return n * s;\n    case 'milliseconds':\n    case 'millisecond':\n    case 'msecs':\n    case 'msec':\n    case 'ms':\n      return n;\n    default:\n      return undefined;\n  }\n}\n\n/**\n * Short format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtShort(ms) {\n  var msAbs = Math.abs(ms);\n  if (msAbs >= d) {\n    return Math.round(ms / d) + 'd';\n  }\n  if (msAbs >= h) {\n    return Math.round(ms / h) + 'h';\n  }\n  if (msAbs >= m) {\n    return Math.round(ms / m) + 'm';\n  }\n  if (msAbs >= s) {\n    return Math.round(ms / s) + 's';\n  }\n  return ms + 'ms';\n}\n\n/**\n * Long format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtLong(ms) {\n  var msAbs = Math.abs(ms);\n  if (msAbs >= d) {\n    return plural(ms, msAbs, d, 'day');\n  }\n  if (msAbs >= h) {\n    return plural(ms, msAbs, h, 'hour');\n  }\n  if (msAbs >= m) {\n    return plural(ms, msAbs, m, 'minute');\n  }\n  if (msAbs >= s) {\n    return plural(ms, msAbs, s, 'second');\n  }\n  return ms + ' ms';\n}\n\n/**\n * Pluralization helper.\n */\n\nfunction plural(ms, msAbs, n, name) {\n  var isPlural = msAbs >= n * 1.5;\n  return Math.round(ms / n) + ' ' + name + (isPlural ? 's' : '');\n}\n","\n/**\n * This is the common logic for both the Node.js and web browser\n * implementations of `debug()`.\n */\n\nfunction setup(env) {\n\tcreateDebug.debug = createDebug;\n\tcreateDebug.default = createDebug;\n\tcreateDebug.coerce = coerce;\n\tcreateDebug.disable = disable;\n\tcreateDebug.enable = enable;\n\tcreateDebug.enabled = enabled;\n\tcreateDebug.humanize = require('ms');\n\n\tObject.keys(env).forEach(key => {\n\t\tcreateDebug[key] = env[key];\n\t});\n\n\t/**\n\t* Active `debug` instances.\n\t*/\n\tcreateDebug.instances = [];\n\n\t/**\n\t* The currently active debug mode names, and names to skip.\n\t*/\n\n\tcreateDebug.names = [];\n\tcreateDebug.skips = [];\n\n\t/**\n\t* Map of special \"%n\" handling functions, for the debug \"format\" argument.\n\t*\n\t* Valid key names are a single, lower or upper-case letter, i.e. \"n\" and \"N\".\n\t*/\n\tcreateDebug.formatters = {};\n\n\t/**\n\t* Selects a color for a debug namespace\n\t* @param {String} namespace The namespace string for the for the debug instance to be colored\n\t* @return {Number|String} An ANSI color code for the given namespace\n\t* @api private\n\t*/\n\tfunction selectColor(namespace) {\n\t\tlet hash = 0;\n\n\t\tfor (let i = 0; i < namespace.length; i++) {\n\t\t\thash = ((hash << 5) - hash) + namespace.charCodeAt(i);\n\t\t\thash |= 0; // Convert to 32bit integer\n\t\t}\n\n\t\treturn createDebug.colors[Math.abs(hash) % createDebug.colors.length];\n\t}\n\tcreateDebug.selectColor = selectColor;\n\n\t/**\n\t* Create a debugger with the given `namespace`.\n\t*\n\t* @param {String} namespace\n\t* @return {Function}\n\t* @api public\n\t*/\n\tfunction createDebug(namespace) {\n\t\tlet prevTime;\n\n\t\tfunction debug(...args) {\n\t\t\t// Disabled?\n\t\t\tif (!debug.enabled) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst self = debug;\n\n\t\t\t// Set `diff` timestamp\n\t\t\tconst curr = Number(new Date());\n\t\t\tconst ms = curr - (prevTime || curr);\n\t\t\tself.diff = ms;\n\t\t\tself.prev = prevTime;\n\t\t\tself.curr = curr;\n\t\t\tprevTime = curr;\n\n\t\t\targs[0] = createDebug.coerce(args[0]);\n\n\t\t\tif (typeof args[0] !== 'string') {\n\t\t\t\t// Anything else let's inspect with %O\n\t\t\t\targs.unshift('%O');\n\t\t\t}\n\n\t\t\t// Apply any `formatters` transformations\n\t\t\tlet index = 0;\n\t\t\targs[0] = args[0].replace(/%([a-zA-Z%])/g, (match, format) => {\n\t\t\t\t// If we encounter an escaped % then don't increase the array index\n\t\t\t\tif (match === '%%') {\n\t\t\t\t\treturn match;\n\t\t\t\t}\n\t\t\t\tindex++;\n\t\t\t\tconst formatter = createDebug.formatters[format];\n\t\t\t\tif (typeof formatter === 'function') {\n\t\t\t\t\tconst val = args[index];\n\t\t\t\t\tmatch = formatter.call(self, val);\n\n\t\t\t\t\t// Now we need to remove `args[index]` since it's inlined in the `format`\n\t\t\t\t\targs.splice(index, 1);\n\t\t\t\t\tindex--;\n\t\t\t\t}\n\t\t\t\treturn match;\n\t\t\t});\n\n\t\t\t// Apply env-specific formatting (colors, etc.)\n\t\t\tcreateDebug.formatArgs.call(self, args);\n\n\t\t\tconst logFn = self.log || createDebug.log;\n\t\t\tlogFn.apply(self, args);\n\t\t}\n\n\t\tdebug.namespace = namespace;\n\t\tdebug.enabled = createDebug.enabled(namespace);\n\t\tdebug.useColors = createDebug.useColors();\n\t\tdebug.color = selectColor(namespace);\n\t\tdebug.destroy = destroy;\n\t\tdebug.extend = extend;\n\t\t// Debug.formatArgs = formatArgs;\n\t\t// debug.rawLog = rawLog;\n\n\t\t// env-specific initialization logic for debug instances\n\t\tif (typeof createDebug.init === 'function') {\n\t\t\tcreateDebug.init(debug);\n\t\t}\n\n\t\tcreateDebug.instances.push(debug);\n\n\t\treturn debug;\n\t}\n\n\tfunction destroy() {\n\t\tconst index = createDebug.instances.indexOf(this);\n\t\tif (index !== -1) {\n\t\t\tcreateDebug.instances.splice(index, 1);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tfunction extend(namespace, delimiter) {\n\t\tconst newDebug = createDebug(this.namespace + (typeof delimiter === 'undefined' ? ':' : delimiter) + namespace);\n\t\tnewDebug.log = this.log;\n\t\treturn newDebug;\n\t}\n\n\t/**\n\t* Enables a debug mode by namespaces. This can include modes\n\t* separated by a colon and wildcards.\n\t*\n\t* @param {String} namespaces\n\t* @api public\n\t*/\n\tfunction enable(namespaces) {\n\t\tcreateDebug.save(namespaces);\n\n\t\tcreateDebug.names = [];\n\t\tcreateDebug.skips = [];\n\n\t\tlet i;\n\t\tconst split = (typeof namespaces === 'string' ? namespaces : '').split(/[\\s,]+/);\n\t\tconst len = split.length;\n\n\t\tfor (i = 0; i < len; i++) {\n\t\t\tif (!split[i]) {\n\t\t\t\t// ignore empty strings\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tnamespaces = split[i].replace(/\\*/g, '.*?');\n\n\t\t\tif (namespaces[0] === '-') {\n\t\t\t\tcreateDebug.skips.push(new RegExp('^' + namespaces.substr(1) + '$'));\n\t\t\t} else {\n\t\t\t\tcreateDebug.names.push(new RegExp('^' + namespaces + '$'));\n\t\t\t}\n\t\t}\n\n\t\tfor (i = 0; i < createDebug.instances.length; i++) {\n\t\t\tconst instance = createDebug.instances[i];\n\t\t\tinstance.enabled = createDebug.enabled(instance.namespace);\n\t\t}\n\t}\n\n\t/**\n\t* Disable debug output.\n\t*\n\t* @return {String} namespaces\n\t* @api public\n\t*/\n\tfunction disable() {\n\t\tconst namespaces = [\n\t\t\t...createDebug.names.map(toNamespace),\n\t\t\t...createDebug.skips.map(toNamespace).map(namespace => '-' + namespace)\n\t\t].join(',');\n\t\tcreateDebug.enable('');\n\t\treturn namespaces;\n\t}\n\n\t/**\n\t* Returns true if the given mode name is enabled, false otherwise.\n\t*\n\t* @param {String} name\n\t* @return {Boolean}\n\t* @api public\n\t*/\n\tfunction enabled(name) {\n\t\tif (name[name.length - 1] === '*') {\n\t\t\treturn true;\n\t\t}\n\n\t\tlet i;\n\t\tlet len;\n\n\t\tfor (i = 0, len = createDebug.skips.length; i < len; i++) {\n\t\t\tif (createDebug.skips[i].test(name)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tfor (i = 0, len = createDebug.names.length; i < len; i++) {\n\t\t\tif (createDebug.names[i].test(name)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t/**\n\t* Convert regexp to namespace\n\t*\n\t* @param {RegExp} regxep\n\t* @return {String} namespace\n\t* @api private\n\t*/\n\tfunction toNamespace(regexp) {\n\t\treturn regexp.toString()\n\t\t\t.substring(2, regexp.toString().length - 2)\n\t\t\t.replace(/\\.\\*\\?$/, '*');\n\t}\n\n\t/**\n\t* Coerce `val`.\n\t*\n\t* @param {Mixed} val\n\t* @return {Mixed}\n\t* @api private\n\t*/\n\tfunction coerce(val) {\n\t\tif (val instanceof Error) {\n\t\t\treturn val.stack || val.message;\n\t\t}\n\t\treturn val;\n\t}\n\n\tcreateDebug.enable(createDebug.load());\n\n\treturn createDebug;\n}\n\nmodule.exports = setup;\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","/* eslint-env browser */\n\n/**\n * This is the web browser implementation of `debug()`.\n */\n\nexports.log = log;\nexports.formatArgs = formatArgs;\nexports.save = save;\nexports.load = load;\nexports.useColors = useColors;\nexports.storage = localstorage();\n\n/**\n * Colors.\n */\n\nexports.colors = [\n\t'#0000CC',\n\t'#0000FF',\n\t'#0033CC',\n\t'#0033FF',\n\t'#0066CC',\n\t'#0066FF',\n\t'#0099CC',\n\t'#0099FF',\n\t'#00CC00',\n\t'#00CC33',\n\t'#00CC66',\n\t'#00CC99',\n\t'#00CCCC',\n\t'#00CCFF',\n\t'#3300CC',\n\t'#3300FF',\n\t'#3333CC',\n\t'#3333FF',\n\t'#3366CC',\n\t'#3366FF',\n\t'#3399CC',\n\t'#3399FF',\n\t'#33CC00',\n\t'#33CC33',\n\t'#33CC66',\n\t'#33CC99',\n\t'#33CCCC',\n\t'#33CCFF',\n\t'#6600CC',\n\t'#6600FF',\n\t'#6633CC',\n\t'#6633FF',\n\t'#66CC00',\n\t'#66CC33',\n\t'#9900CC',\n\t'#9900FF',\n\t'#9933CC',\n\t'#9933FF',\n\t'#99CC00',\n\t'#99CC33',\n\t'#CC0000',\n\t'#CC0033',\n\t'#CC0066',\n\t'#CC0099',\n\t'#CC00CC',\n\t'#CC00FF',\n\t'#CC3300',\n\t'#CC3333',\n\t'#CC3366',\n\t'#CC3399',\n\t'#CC33CC',\n\t'#CC33FF',\n\t'#CC6600',\n\t'#CC6633',\n\t'#CC9900',\n\t'#CC9933',\n\t'#CCCC00',\n\t'#CCCC33',\n\t'#FF0000',\n\t'#FF0033',\n\t'#FF0066',\n\t'#FF0099',\n\t'#FF00CC',\n\t'#FF00FF',\n\t'#FF3300',\n\t'#FF3333',\n\t'#FF3366',\n\t'#FF3399',\n\t'#FF33CC',\n\t'#FF33FF',\n\t'#FF6600',\n\t'#FF6633',\n\t'#FF9900',\n\t'#FF9933',\n\t'#FFCC00',\n\t'#FFCC33'\n];\n\n/**\n * Currently only WebKit-based Web Inspectors, Firefox >= v31,\n * and the Firebug extension (any Firefox version) are known\n * to support \"%c\" CSS customizations.\n *\n * TODO: add a `localStorage` variable to explicitly enable/disable colors\n */\n\n// eslint-disable-next-line complexity\nfunction useColors() {\n\t// NB: In an Electron preload script, document will be defined but not fully\n\t// initialized. Since we know we're in Chrome, we'll just detect this case\n\t// explicitly\n\tif (typeof window !== 'undefined' && window.process && (window.process.type === 'renderer' || window.process.__nwjs)) {\n\t\treturn true;\n\t}\n\n\t// Internet Explorer and Edge do not support colors.\n\tif (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/(edge|trident)\\/(\\d+)/)) {\n\t\treturn false;\n\t}\n\n\t// Is webkit? http://stackoverflow.com/a/16459606/376773\n\t// document is undefined in react-native: https://github.com/facebook/react-native/pull/1632\n\treturn (typeof document !== 'undefined' && document.documentElement && document.documentElement.style && document.documentElement.style.WebkitAppearance) ||\n\t\t// Is firebug? http://stackoverflow.com/a/398120/376773\n\t\t(typeof window !== 'undefined' && window.console && (window.console.firebug || (window.console.exception && window.console.table))) ||\n\t\t// Is firefox >= v31?\n\t\t// https://developer.mozilla.org/en-US/docs/Tools/Web_Console#Styling_messages\n\t\t(typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/firefox\\/(\\d+)/) && parseInt(RegExp.$1, 10) >= 31) ||\n\t\t// Double check webkit in userAgent just in case we are in a worker\n\t\t(typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/applewebkit\\/(\\d+)/));\n}\n\n/**\n * Colorize log arguments if enabled.\n *\n * @api public\n */\n\nfunction formatArgs(args) {\n\targs[0] = (this.useColors ? '%c' : '') +\n\t\tthis.namespace +\n\t\t(this.useColors ? ' %c' : ' ') +\n\t\targs[0] +\n\t\t(this.useColors ? '%c ' : ' ') +\n\t\t'+' + module.exports.humanize(this.diff);\n\n\tif (!this.useColors) {\n\t\treturn;\n\t}\n\n\tconst c = 'color: ' + this.color;\n\targs.splice(1, 0, c, 'color: inherit');\n\n\t// The final \"%c\" is somewhat tricky, because there could be other\n\t// arguments passed either before or after the %c, so we need to\n\t// figure out the correct index to insert the CSS into\n\tlet index = 0;\n\tlet lastC = 0;\n\targs[0].replace(/%[a-zA-Z%]/g, match => {\n\t\tif (match === '%%') {\n\t\t\treturn;\n\t\t}\n\t\tindex++;\n\t\tif (match === '%c') {\n\t\t\t// We only are interested in the *last* %c\n\t\t\t// (the user may have provided their own)\n\t\t\tlastC = index;\n\t\t}\n\t});\n\n\targs.splice(lastC, 0, c);\n}\n\n/**\n * Invokes `console.log()` when available.\n * No-op when `console.log` is not a \"function\".\n *\n * @api public\n */\nfunction log(...args) {\n\t// This hackery is required for IE8/9, where\n\t// the `console.log` function doesn't have 'apply'\n\treturn typeof console === 'object' &&\n\t\tconsole.log &&\n\t\tconsole.log(...args);\n}\n\n/**\n * Save `namespaces`.\n *\n * @param {String} namespaces\n * @api private\n */\nfunction save(namespaces) {\n\ttry {\n\t\tif (namespaces) {\n\t\t\texports.storage.setItem('debug', namespaces);\n\t\t} else {\n\t\t\texports.storage.removeItem('debug');\n\t\t}\n\t} catch (error) {\n\t\t// Swallow\n\t\t// XXX (@Qix-) should we be logging these?\n\t}\n}\n\n/**\n * Load `namespaces`.\n *\n * @return {String} returns the previously persisted debug modes\n * @api private\n */\nfunction load() {\n\tlet r;\n\ttry {\n\t\tr = exports.storage.getItem('debug');\n\t} catch (error) {\n\t\t// Swallow\n\t\t// XXX (@Qix-) should we be logging these?\n\t}\n\n\t// If debug isn't set in LS, and we're in Electron, try to load $DEBUG\n\tif (!r && typeof process !== 'undefined' && 'env' in process) {\n\t\tr = process.env.DEBUG;\n\t}\n\n\treturn r;\n}\n\n/**\n * Localstorage attempts to return the localstorage.\n *\n * This is necessary because safari throws\n * when a user disables cookies/localstorage\n * and you attempt to access it.\n *\n * @return {LocalStorage}\n * @api private\n */\n\nfunction localstorage() {\n\ttry {\n\t\t// TVMLKit (Apple TV JS Runtime) does not have a window object, just localStorage in the global context\n\t\t// The Browser also has localStorage in the global context.\n\t\treturn localStorage;\n\t} catch (error) {\n\t\t// Swallow\n\t\t// XXX (@Qix-) should we be logging these?\n\t}\n}\n\nmodule.exports = require('./common')(exports);\n\nconst {formatters} = module.exports;\n\n/**\n * Map %j to `JSON.stringify()`, since no Web Inspectors do that by default.\n */\n\nformatters.j = function (v) {\n\ttry {\n\t\treturn JSON.stringify(v);\n\t} catch (error) {\n\t\treturn '[UnexpectedJSONParseError]: ' + error.message;\n\t}\n};\n","import { MediaInformation } from \"chromecast-caf-receiver/cast.framework.messages\";\n\n/*\n * Misc types\n */\n\n// tslint:disable no-bitwise\nexport enum SenderCapabilities {\n    None = 0,\n\n    DeferredInfo = 1 << 1,\n\n    QueueNext = 1 << 2,\n    QueuePrev = 1 << 3,\n}\n\nexport function hasCapability(\n    haystack: SenderCapabilities,\n    needle: SenderCapabilities,\n) {\n    return (haystack & needle) === needle;\n}\n// tslint:enable no-bitwise\n\nexport interface IBabblerCustomData {\n    capabilities?: SenderCapabilities;\n    license?: {\n        ipc?: boolean;\n        url?: string;\n    };\n}\n\n/*\n * RPC core types\n */\n\nexport interface IRpcResponseData<TData> {\n    response: TData;\n    responseTo: number;\n    type: string;\n}\n\nexport interface IRpcResponse<T> extends cast.framework.events.Event {\n    data: IRpcResponseData<T>;\n}\n\nexport function isRpcResponse<T>(ev: cast.framework.events.Event): ev is IRpcResponse<T> {\n    const data = (ev as any).data;\n    return data && data.responseTo;\n}\n\nexport class RPC<TReq, TResponseData> {\n    constructor(\n        public requestType: string,\n        public responseType: string = `${requestType}_RESPONSE`,\n        public timeoutMillis: number = 15000,\n    ) {}\n}\n\nexport type ReqArgsFor<T extends RPC<any, any>> =\n    T extends RPC<infer TReq, infer TResponseData> ? TReq :\n    never;\n\nexport type ResponseDataFor<T extends RPC<any, any>> =\n    T extends RPC<infer TReq, infer TResponseData> ? TResponseData :\n    never;\n\n/**\n * INFO request\n */\n\nexport const INFO = new RPC<IInfoRequest, MediaInformation>(\"INFO\");\n\nexport interface IInfoRequest {\n    contentId: string;\n}\n\n/*\n * LICENSE request\n */\n\n/**\n * @return license data in base64 encoding\n */\nexport const LICENSE = new RPC<ILicenseRequest, string>(\"LICENSE\");\n\nexport interface ILicenseRequest {\n    url?: string;\n    base64: string;\n}\n\n/*\n * QUEUE request\n */\n\nexport const QUEUE = new RPC<IQueueRequest, IQueueResponse[]>(\"QUEUE\");\n\nexport interface IQueueRequest {\n    mode: \"before\" | \"after\";\n    contentId: string;\n}\n\nexport interface IQueueResponse {\n    contentId: string;\n    currentTime?: number;\n    customData?: IBabblerCustomData;\n    metadata: cast.framework.messages.MediaMetadata;\n}\n","\nexport function ab2str(buf: ArrayBuffer) {\n    return String.fromCharCode.apply(null, new Uint8Array(buf) as any);\n}\n\nexport function str2ab(str: string) {\n    return Uint8Array.from(atob(str), c => c.charCodeAt(0));\n}\n","import _debug from \"debug\";\nconst debug = _debug(\"babbler:license\");\n\nimport { LICENSE } from \"./messages\";\nimport { RpcManager } from \"./rpc\";\nimport { ab2str, str2ab } from \"./util\";\n\nexport class LicenseHandler extends EventTarget {\n    public static init(\n        context: cast.framework.CastReceiverContext,\n        playbackConfig: cast.framework.PlaybackConfig,\n        rpc: RpcManager,\n    ) {\n        const handler = new LicenseHandler(\n            rpc,\n        );\n\n        playbackConfig.licenseRequestHandler = handler.handleLicenseRequest.bind(handler);\n\n        // NOTE: the typings don't allow for a promise, but the API does\n        playbackConfig.licenseHandler = data => {\n            try {\n                return handler.handleLicenseData(data) as any;\n            } catch (e) {\n                debug(\"error handling licenseRequest\", e);\n            }\n        };\n\n        debug(\"initialized LicenseHandler\");\n\n        return handler;\n    }\n\n    constructor(\n        private rpc: RpcManager,\n    ) {\n        super();\n    }\n\n    public handleLicenseRequest(\n        requestInfo: cast.framework.NetworkRequestInfo,\n    ) {\n        const originalUrl = requestInfo.url;\n        if (!/^ipc:\\/\\//.test(originalUrl)) {\n            // just allow the default behavior\n            return null;\n        }\n\n        // route through IPC\n        const dataBase64 = btoa(ab2str(requestInfo.content));\n        requestInfo.url = \"data://application/json,\" + JSON.stringify({\n            data: dataBase64,\n            url: originalUrl.substring(\"ipc://\".length),\n        });\n    }\n\n    public async handleLicenseData(\n        data: Uint8Array,\n    ): Promise<{buffer: ArrayBuffer}> {\n        const asString = ab2str(data);\n\n        let obj;\n        try {\n            obj = JSON.parse(asString);\n        } catch (e) {\n            // not JSON? return original response data unmolested\n            return data;\n        }\n\n        debug(\">> license request\");\n\n        const base64 = await this.rpc.send(LICENSE, {\n            base64: obj.data,\n            url: obj.url,\n        });\n\n        this.dispatchEvent(new Event(\"LICENSE_RESPONSE\"));\n        debug(\"<< got license response\");\n\n        return str2ab(base64);\n    }\n}\n","import debug_ from \"debug\";\nconst debug = debug_(\"babbler:playback\");\n\nimport { IPlayerManagerEx } from \"chromecast-caf-receiver/cast.framework\";\nimport { LicenseHandler } from \"./license\";\nimport { hasCapability, INFO, SenderCapabilities } from \"./messages\";\nimport { BabblerQueue } from \"./queue\";\nimport { RpcManager } from \"./rpc\";\n\n// TODO do some debouncing instead of just guessing like this...?\nconst EXPECTED_LICENSE_REQUESTS = 4;\n\nconst DELAY = 2000;\n\nenum HangFixState {\n    NO_HANG,\n    FIX_ENQUEUED,\n    FIX_ATTEMPTED,\n    FIX_ERRORED,\n\n    FIX_ERRORED_RESOLVING,\n}\n\n/**\n * Remove eg `http:` from an URL so it will load with the correct\n * protocol depending on whether this page is served over HTTPS\n * or HTTP\n */\nfunction stripUrlProtocol(url: string) {\n    return url.replace(/^http[s]?:/, \"\");\n}\n\nexport class PlaybackHandler {\n    public static init(\n        context: cast.framework.CastReceiverContext,\n        rpc: RpcManager,\n        licenses: LicenseHandler,\n        queue: BabblerQueue,\n    ) {\n        const playerManager = context.getPlayerManager();\n\n        const handler = new PlaybackHandler(\n            playerManager,\n            rpc,\n            queue,\n        );\n\n        playerManager.addEventListener(\n            cast.framework.events.category.CORE,\n            event => {\n                debug(\"EVENT\", event);\n\n                if (event.type === \"REQUEST_LOAD\") {\n                    const ev = event as cast.framework.events.RequestEvent;\n                    if (ev.senderId !== \"\") {\n                        rpc.setActiveSender(ev.senderId);\n                    }\n                }\n            },\n        );\n\n        // we may be interested in error events:\n        playerManager.addEventListener(\n            cast.framework.events.EventType.ERROR,\n            event => handler.dispatchErrorEvent(\n                event as cast.framework.events.ErrorEvent,\n            ),\n        );\n\n        // gross, but necessary due to incomplete typings:\n        const pmEx = playerManager as unknown as IPlayerManagerEx;\n        pmEx.setMessageInterceptor(\n            cast.framework.messages.MessageType.LOAD,\n            handler.interceptLoadMessage.bind(handler),\n        );\n\n        playerManager.setMediaPlaybackInfoHandler(\n            handler.handleMediaPlaybackInfo.bind(handler),\n        );\n\n        // this is not the best way to deal with this, but even after\n        // getting all license requests answered successfully sometimes\n        // the player hangs; this hook lets us try to resolve that:\n        licenses.addEventListener(\"LICENSE_RESPONSE\", () => {\n            handler.onLicenseResponseReceived();\n        });\n\n        return handler;\n    }\n\n    private licenseResponsesReceived = 0;\n    private hangFixState: HangFixState = HangFixState.NO_HANG;\n\n    constructor(\n        private playerManager: cast.framework.PlayerManager,\n        private rpc: RpcManager,\n        private queue: BabblerQueue,\n    ) {}\n\n    public async interceptLoadMessage(\n        loadRequestData: cast.framework.messages.LoadRequestData,\n    ) {\n        debug(\"new LOAD request received\", loadRequestData);\n\n        // reset state for new media\n        this.licenseResponsesReceived = 0;\n        this.hangFixState = HangFixState.NO_HANG;\n\n        if (\n            loadRequestData.customData\n            && loadRequestData.customData.capabilities\n        ) {\n            const { capabilities } = loadRequestData.customData;\n            this.queue.setSenderCapabilities(\n                capabilities,\n            );\n\n            if (hasCapability(capabilities, SenderCapabilities.DeferredInfo)) {\n                const media = await this.rpc.send(INFO, {\n                    contentId: loadRequestData.media.contentId,\n                });\n\n                // move customData out of the media object onto the\n                // loadRequest so we're not broadcasting it\n                if (media.customData) {\n                    loadRequestData.customData = Object.assign(\n                        loadRequestData.customData,\n                        media.customData,\n                    );\n                    delete media.customData;\n                }\n\n                loadRequestData.media = Object.assign(\n                    loadRequestData.media,\n                    media,\n                );\n            }\n        }\n\n        if (loadRequestData.media) {\n            if (loadRequestData.media.contentId) {\n                loadRequestData.media.contentId = stripUrlProtocol(loadRequestData.media.contentId);\n            }\n\n            if (loadRequestData.media.contentUrl) {\n                loadRequestData.media.contentUrl = stripUrlProtocol(loadRequestData.media.contentUrl);\n            }\n\n            const meta = loadRequestData.media.metadata;\n            if (meta && (meta as any).images) {\n                const mediaMetdata = meta as cast.framework.messages.GenericMediaMetadata;\n                for (const image of mediaMetdata.images) {\n                    image.url = stripUrlProtocol(image.url);\n                }\n            }\n        }\n\n        return loadRequestData;\n    }\n\n    public async handleMediaPlaybackInfo(\n        loadRequest: cast.framework.messages.LoadRequestData,\n        playbackConfig: cast.framework.PlaybackConfig,\n    ) {\n        debug(\"mediaPlaybackInfo\", loadRequest);\n\n        if (loadRequest.customData && loadRequest.customData.license) {\n            const { license } = loadRequest.customData;\n            if (license.url) {\n                playbackConfig.licenseUrl = license.url;\n            }\n\n            if (license.ipc) {\n                const licenseUrl = playbackConfig.licenseUrl || \"\";\n                const uri = \"ipc://\" + encodeURIComponent(licenseUrl);\n                playbackConfig.licenseUrl = uri;\n            }\n        }\n\n        (playbackConfig as any).shakaConfig = {\n            // hacks to force widevine loading:\n            manifest: {\n                dash: {\n                    ignoreDrmInfo: true,\n                },\n            },\n        };\n\n        // hacks for local testing:\n        if (process.env.NODE_ENV !== \"production\") {\n            (playbackConfig as any).shakaConfig.drm = {\n                advanced: {\n                    \"com.widevine.alpha\": {\n                        audioRobustness: \"\",\n                        videoRobustness: \"\",\n                    },\n                },\n            };\n        }\n\n        return playbackConfig;\n    }\n\n    public onLicenseResponseReceived() {\n        const received = ++this.licenseResponsesReceived;\n        if (\n            this.hangFixState !== HangFixState.NO_HANG\n            || received < EXPECTED_LICENSE_REQUESTS\n        ) {\n            return;\n        }\n\n        this.hangFixState = HangFixState.FIX_ENQUEUED;\n\n        setTimeout(() => {\n            switch (this.playerManager.getPlayerState()) {\n            case \"BUFFERING\":\n                debug(\"attempt to fix hang\");\n\n                this.hangFixState = HangFixState.FIX_ATTEMPTED;\n                this.playerManager.play();\n                break;\n\n            case \"PLAYING\":\n                this.hangFixState = HangFixState.NO_HANG;\n                break;\n            }\n        }, DELAY);\n    }\n\n    public dispatchErrorEvent(error: cast.framework.events.ErrorEvent) {\n        debug(\n            \"error event #\", error.detailedErrorCode,\n            \"hangFixState=\", this.hangFixState,\n        );\n\n        // sigh:\n        const errorCode = error.detailedErrorCode as unknown as number;\n\n        if (\n            this.hangFixState === HangFixState.FIX_ATTEMPTED\n                && errorCode === 906\n        ) {\n            this.hangFixState = HangFixState.FIX_ERRORED;\n            const state = this.playerManager.getPlayerState();\n            if (state === \"PLAYING\") {\n                this.hangFixState = HangFixState.NO_HANG; // FIXED\n                debug(\"fixed hang\");\n                return;\n            }\n\n            // media error message; we tried to force playback\n            // but it wasn't ready... I guess?\n            this.playerManager.pause();\n            this.hangFixState = HangFixState.FIX_ERRORED_RESOLVING;\n\n            debug(\n                \"failed to force playback... try again; state=\",\n                state,\n            );\n\n            setTimeout(() => {\n                const newState = this.playerManager.getPlayerState();\n                if (newState === \"PAUSED\") {\n                    debug(\"resolve hangfix error; state=\", state);\n                    this.playerManager.play();\n                } else {\n                    debug(\"unable to resolve hangfix error; state=\", state);\n                }\n            }, DELAY);\n        }\n    }\n}\n","import debug_ from \"debug\";\nconst debug = debug_(\"babbler:queue\");\n\nimport { hasCapability, IQueueResponse, QUEUE, SenderCapabilities } from \"./messages\";\nimport { RpcManager } from \"./rpc\";\n\ntype QueueItem = cast.framework.messages.QueueItem;\n\nexport class BabblerQueue extends cast.framework.QueueBase {\n    public static create(\n        context: cast.framework.CastReceiverContext,\n        rpc: RpcManager,\n    ) {\n        return new BabblerQueue(\n            context.getPlayerManager().getQueueManager(),\n            rpc,\n        );\n    }\n\n    private capabilities: SenderCapabilities = SenderCapabilities.None;\n\n    constructor(\n        private mgr: cast.framework.QueueManager,\n        private rpc: RpcManager,\n    ) {\n        super();\n    }\n\n    public async nextItems(itemId?: number): Promise<QueueItem[]> {\n        return this.fetchRelativeTo(\"after\", SenderCapabilities.QueueNext, itemId);\n    }\n\n    public async prevItems(itemId?: number): Promise<QueueItem[]> {\n        return this.fetchRelativeTo(\"before\", SenderCapabilities.QueuePrev, itemId);\n    }\n\n    public setSenderCapabilities(\n        capabilities: SenderCapabilities,\n    ) {\n        this.capabilities = capabilities;\n    }\n\n    private async fetchRelativeTo(\n        mode: \"before\" | \"after\",\n        capability: SenderCapabilities,\n        itemId?: number,\n    ) {\n        if (!itemId) {\n            debug(`no itemId passed to fetch(${mode})`);\n            return [];\n        }\n\n        if (!hasCapability(this.capabilities, capability)) {\n            debug(\"current sender isn't capable of fetching\", mode);\n            return [];\n        }\n\n        const items = this.mgr.getItems();\n        const fetchAfter = items.find(item => item.itemId === itemId);\n        if (!fetchAfter) {\n            debug(\"Couldn't determine which item to fetch after\");\n            return [];\n        }\n\n        if (!fetchAfter.media) {\n            throw new Error(\"No media attached to queue item\");\n        }\n\n        const { contentId } = fetchAfter.media;\n        debug(`fetch items ${mode}`, contentId);\n        const result = await this.rpc.send(QUEUE, {\n            contentId,\n            mode,\n        });\n\n        debug(` queue(${mode} ${contentId}) <- `, result);\n        return result.map(toQueueItem);\n    }\n}\n\nfunction toQueueItem(item: IQueueResponse): QueueItem {\n    const result = new cast.framework.messages.QueueItem();\n    result.media = {\n        contentId: item.contentId,\n        contentType: \"video/mp4\", // TODO ?\n        contentUrl: item.contentId,\n        metadata: item.metadata,\n        streamType: \"BUFFERED\",\n    };\n    result.startTime = item.currentTime;\n    result.customData = item.customData;\n    return result;\n}\n","import _debug from \"debug\";\nimport { isRpcResponse, ReqArgsFor, ResponseDataFor, RPC } from \"./messages\";\nconst debug = _debug(\"babbler:rpc\");\n\nconst NS = \"urn:x-cast:com.github.dhleong.babbler\";\n\ntype RequestResolver<T> = (result: T) => void;\n\nclass PendingRequest<T extends RPC<any, any>> {\n    constructor(\n        public rpc: T,\n        public resolve: RequestResolver<ResponseDataFor<T>>,\n    ) {}\n}\n\nexport class RpcManager {\n    public static create(\n        context: cast.framework.CastReceiverContext =\n            cast.framework.CastReceiverContext.getInstance(),\n    ) {\n        const instance = new RpcManager(context);\n        context.addCustomMessageListener(NS, msg => instance.onMessage(msg));\n\n        debug(\"created RpcManager\");\n        return instance;\n    }\n\n    private nextRequestId = 1;\n    private pendingRequests: {[key: number]: PendingRequest<RPC<any, any>>} = {};\n\n    private activeSenderId: string | undefined;\n\n    private constructor(\n        private context: cast.framework.CastReceiverContext,\n    ) { }\n\n    public send<TRPC extends RPC<any, any>>(\n        rpc: TRPC,\n        data: ReqArgsFor<TRPC>,\n    ): Promise<ResponseDataFor<TRPC>> {\n        const requestId = this.nextRequestId++;\n        debug(`send ${rpc.requestType} #${requestId} to ${this.activeSenderId}`);\n        this.context.sendCustomMessage(\n            NS,\n\n            // NOTE: the typings don't allow undefined here, but\n            // it *is* acceptable for broadcast\n            this.activeSenderId as string,\n\n            Object.assign({\n                requestId,\n                type: rpc.requestType,\n            }, data),\n        );\n\n        return new Promise((resolve, reject) => {\n            const timeoutHandle = setTimeout(() => {\n                const message = `TIMEOUT waiting for response to ${rpc.requestType} #${requestId}`;\n                debug(message);\n                reject(new Error(message));\n            }, rpc.timeoutMillis);\n\n            this.pendingRequests[requestId] = new PendingRequest(\n                rpc,\n                response => {\n                    clearTimeout(timeoutHandle);\n                    resolve(response);\n                },\n            );\n        });\n    }\n\n    /**\n     * Set the ID of the sender to whom we will send\n     * messages\n     */\n    public setActiveSender(senderId: string | undefined) {\n        debug(\"activeSenderId <-\", senderId);\n        this.activeSenderId = senderId;\n    }\n\n    private onMessage(msg: cast.framework.events.Event) {\n        if (!isRpcResponse(msg)) return;\n\n        debug(\"received\", msg);\n        const req = this.pendingRequests[msg.data.responseTo];\n        if (!req) return;\n\n        if (msg.data.type !== req.rpc.responseType) {\n            throw new Error(\n                `Expected '${req.rpc.responseType}' ` +\n                `in response to '${req.rpc.requestType}'` +\n                `but got '${msg.type}'`,\n            );\n        }\n\n        delete this.pendingRequests[msg.data.responseTo];\n        req.resolve(msg.data.response);\n    }\n\n}\n","import debug from \"debug\";\n\nif (process.env.NODE_ENV !== \"production\") {\n    debug.enable(\"babbler:*\");\n}\n\nimport { LicenseHandler } from \"./license\";\nimport { PlaybackHandler } from \"./playback\";\nimport { BabblerQueue } from \"./queue\";\nimport { RpcManager } from \"./rpc\";\n\n// shared singleton instance\nconst rpc = RpcManager.create();\n\nconst context = cast.framework.CastReceiverContext.getInstance();\nconst playbackConfig = new cast.framework.PlaybackConfig();\n\nconst licenses = LicenseHandler.init(context, playbackConfig, rpc);\nconst queue = BabblerQueue.create(context, rpc);\n\nPlaybackHandler.init(context, rpc, licenses, queue);\n\n// tslint:disable no-bitwise\ncontext.start({\n    playbackConfig,\n    queue,\n    supportedCommands:\n        cast.framework.messages.Command.ALL_BASIC_MEDIA\n        | cast.framework.messages.Command.QUEUE_NEXT,\n});\n"]}